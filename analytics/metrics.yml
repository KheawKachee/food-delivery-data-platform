version: 2

metrics:
  - name: total_orders
    label: Total Orders
    model: ref('mart_hourly_total_spends')
    calculation_method: sum
    expression: n_orders
    timestamp: hourly
    time_grains: [hour, day]

  - name: total_revenue
    label: Total Revenue
    model: ref('mart_hourly_total_spends')
    calculation_method: sum
    expression: total_price_baht
    timestamp: hourly
    time_grains: [hour, day]

  - name: avg_delivery_time_min
    label: Avg Delivery Time (min)
    model: ref('mart_delivery_time')
    calculation_method: average
    expression: delivery_time_min
    timestamp: order_ts
    time_grains: [hour, day]

  - name: avg_rider_rating
    label: Avg Rider Rating
    model: ref('mart_avg_rider_rating')
    calculation_method: average
    expression: avg_rating
